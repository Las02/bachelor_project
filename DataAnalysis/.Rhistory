select(.y.=`Antibiotic resistant`)
pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrats <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts
map(contrasts$contrast, ~str_split_1(.x, "/")
map(contrasts$contrast, ~str_split_1(.x, "/")
map(contrasts$contrast, ~str_split_1(.x, "/")
map(contrasts$contrast, ~str_split_1(.x, "/")
map(contrasts$contrast, ~str_split_1(.x, "/"))
map(contrasts$contrast, ~str_split_1(.x, "/")[1])
map(contrasts$contrast, ~str_split_1(.x, "/")[[1]])
map(contrasts$contrast, ~str_split_1(.x, "/")[[2]])
map(contrasts$contrast, ~str_split_1(.x, "/")[[1]])
map(contrasts$contrast, ~str_split_1(.x, "/")[[2]])
contrast
contrasts
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts
contrasts <- contrasts %>% select(.y.=`Phylum`, group1, group2, p=p.value)
p1 + stat_pvalue_manual(contrasts)
library(ggpubr)
p1 + stat_pvalue_manual(contrasts)
contrasts
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts
p1 + stat_pvalue_manual(contrasts)
library(ggpubr)
p1 + stat_pvalue_manual(contrasts)
p1 + stat_pvalue_manual(contrasts, y.position = ".y.")
contrasts
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts <- contrasts %>% select(.y.=`Phylum`, group1, group2, p=p.value)
contrasts
p1 + stat_pvalue_manual(contrasts, y.position = ".y.")
p1
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts
contrasts <- contrasts %>% select(.y.=`Phylum`, group1, group2, p=p.value)
contrasts
library(ggpubr)
p1 + stat_pvalue_manual(contrasts, y.position = "predicted")
dfpredict$
library(ggpubr)
dfpredict$predicted
## Plotting the Partial residuals + marginal means
dfpredict <- ggemmeans(fit, back.transform = T,terms=c("Phylum","Antibiotic resistant"))
p1 <- plot(dfpredict, dot.size = 0.3, residuals =   T, ci=T) +
geom_point(aes(y=predicted, fill=group), position = position_dodge(0.25))+
ggtitle("")
p1 + p2 + plot_annotation(tag_levels = "A")
p1 + p2 + plot_annotation(tag_levels = "A")
## Testing the difference in AR between phylums, through the estimated marginal means
emm <- emmeans(fit, specs = c("Antibiotic resistant","Phylum"))
pair <- pairs(emm, simple="each", type="response")
pair <- pairs(emm, simple="each", type="response")
pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts <- contrasts %>% select(.y.=`Phylum`, group1, group2, p=p.value)
dfpredict$predicted
p1
contrasts <- contrasts %>% select(.x.=`Phylum`, group1, group2, p=p.value)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts <- contrasts %>% select(.x.=`Phylum`, group1, group2, p=p.value)
contrasts$y <- c(1,2,3,4)
dfpredict$predicted
library(ggpubr)
p1 + stat_pvalue_manual(contrasts, y.position = "y")
p1 + stat_pvalue_manual(contrasts, y.position = "y")
contrasts
contrasts <- contrasts %>% select(group1, group2, p=p.value)
contrasts <- contrasts %>% select(group1, group2, p=p.value)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts <- contrasts %>% select(group1, group2, p=p.value)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(1,2,3,4)
contrasts <- contrasts %>% select(group1, group2, p=p.value)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(1,2,3,4)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value)
p1 + stat_pvalue_manual(contrasts, y.position = "y",)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(1,2,3,4)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`)
dfpredict$predicted
library(ggpubr)
contrasts
p1 + stat_pvalue_manual(contrasts, y.position = "y",)
contrasts$y <- c(1,2,3,4,5,6)
dfpredict$predicted
library(ggpubr)
contrasts
p1 + stat_pvalue_manual(contrasts, y.position = "y",)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(1,2,3,4)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`)
p1 + stat_pvalue_manual(contrasts, y.position = "y",)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(5,5,5,5)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`)
dfpredict$predicted
library(ggpubr)
contrasts
p1 + stat_pvalue_manual(contrasts, y.position = "y",)
contrasts
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`) %>% mutate(group1=factor(group1),group2=factor(group2))
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(5,5,5,5)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`) %>% mutate(group1=factor(group1),group2=factor(group2))
p1 + stat_pvalue_manual(contrasts, y.position = "y",)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(5,5,5,5)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`) %>% mutate(group1=factor(group1),group2=factor(group2))
contrasts
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08,)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(5,5,5,5)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`)
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08,)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, `Phylum`)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(5,5,5,5)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, `Phylum`)
contrasts
dfpredict$predicted
library(ggpubr)
contrasts
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08,)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, supp=`Phylum`)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, supp=`Phylum`)
library(ggpubr)
contrasts
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08,gro)
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08,gro)
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08)
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08)
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(5,5,5,5)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, supp=`Phylum`)
contrasts
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08)
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`)
contrasts <- pair$`simple contrasts for Antibiotic resistant` %>% tidy()
contrasts$group1 <- c(0,0,0,0)
contrasts$group2 <- c(1,1,1,1)
contrasts$y <- c(5,5,5,5)
contrasts <- contrasts %>% select(y,group1, group2, p=p.value, group_col=`Phylum`)
p1 + stat_pvalue_manual(contrasts, y.position = 5, step.increase =0.08)
p1
library(emmeans)
## Calculating the marginal means
ggemmeans(fit, back.transform = T,terms=c("Antibiotic resistant"))
## Plotting the Partial residuals + marginal means
dfpredict <- ggemmeans(fit, back.transform = T,terms=c("Phylum","Antibiotic resistant"))
p1 <- plot(dfpredict, dot.size = 0.3, residuals =   T, ci=T) +
geom_point(aes(y=predicted, fill=group), position = position_dodge(0.25))+
ggtitle("")
## Plotting the violin plots of the distribution
p2 <- Dt_bt %>%
ggplot(aes(col=`Antibiotic resistant`,y=`16S rDNA copy number`, x=Phylum)) +
geom_violin(draw_quantiles = c(0.5))
p1 + p2 + plot_annotation(tag_levels = "A")
## Testing the difference in AR between phylums, through the estimated marginal means
emm <- emmeans(fit, specs = c("Antibiotic resistant","Phylum"))
pair <- pairs(emm, simple="each", type="response")
pair$`simple contrasts for Antibiotic resistant` %>% tidy()
stat.test <- tibble::tribble(
~group1, ~group2,   ~p.adj,
"0.5",     "1", 2.54e-07,
"0.5",     "2", 1.32e-13,
"1",     "2", 1.91e-05
)
stat.test <- tibble::tribble(
~group1, ~group2,   ~p.adj,
"0.5",     "1", 2.54e-07,
"0.5",     "2", 1.32e-13,
"1",     "2", 1.91e-05
)
stat_test
stat.test <- tibble::tribble(
~group1, ~group2,   ~p.adj,
"0.5",     "1", 2.54e-07,
"0.5",     "2", 1.32e-13,
"1",     "2", 1.91e-05
)
stat_test
stat.test <- tibble::tribble(
~group1, ~group2,   ~p.adj,
"0.5",     "1", 2.54e-07,
"0.5",     "2", 1.32e-13,
"1",     "2", 1.91e-05
)
stat.test <- tibble::tribble(
~group1, ~group2,   ~p.adj,
"0.5",     "1", 2.54e-07,
"0.5",     "2", 1.32e-13,
"1",     "2", 1.91e-05
)
stat_test
stat.test <- tibble::tribble(
~group1, ~group2,   ~p.adj,
"0.5",     "1", 2.54e-07,
"0.5",     "2", 1.32e-13,
"1",     "2", 1.91e-05
)
stat.test
dfpredict
dfpredict$group
dfpredict %>% tidy()
dfpredict %>%
ggplot(aes(y=predicted, x=group)) +
geom_point()
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point()
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25))
dfpredict$group
dfpredict
pair$`simple contrasts for Antibiotic resistant` %>% tidy()
pair$`simple contrasts for Antibiotic resistant` %>% tidy()
dfpredict$group
dfpredict$x
unique(dfpredict$x)
pair$`simple contrasts for Antibiotic resistant` %>% tidy()
pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- c(0,0,0,0)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- c(0,0,0,0)
test$group2 <- c(1,1,1,1)
test
test
test <- mutate(x=factor(Phylum))
test <- mutate(x=factor(Phylum))
test <- mutate(x=factor(`Phylum`))
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- c(0,0,0,0)
test$group2 <- c(1,1,1,1)
test <- mutate(x=factor(`Phylum`))
test
test <- mutate(test,x=factor(`Phylum`))
test
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25))
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
test$y.position = c(5,5,5,5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test,)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- c(0,0,0,0)
test$group2 <- c(1,1,1,1)
test$y.position = c(5,5,5,5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test,)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- c(0,0,0,0)
test$group2 <- c(1,1,1,1)
test$y.position = c(5,5,5,5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test,)
test$y.position <- c(5,5,5,5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- c(0,0,0,0)
test$group2 <- c(1,1,1,1)
test$y.position <- c(5,5,5,5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test,)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
test
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
test
test
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
test$y.position <- c(2,3,4,5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- c(0,0,0,0)
test$group2 <- c(1,1,1,1)
test$y.position <- c(2,3,4,5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
test
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
test$group1 <- as.character(c(0,0,0,0))
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- as.character(c(0,0,0,0))
test$group2 <- as.character(c(1,1,1,1))
test$y.position <- c(2,3,4,5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
test
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
dfpredict %>%
ggplot(aes(y=predicted, x=x)) +
facet_wrap(~group)
dfpredict %>%
ggplot(aes(y=predicted, x=x)) +
facet_wrap(~x)
dfpredict %>%
ggplot(aes(y=predicted, x=group)) +
facet_wrap(~x)
test
dfpredict %>%
ggplot(aes(y=predicted, x=group)) +
facet_wrap(~x)
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
, col=group
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25)) +
stat_pvalue_manual(test)
dfpredict %>%
ggplot(aes(y=predicted, x=group)) +
geom_point() +
facet_wrap(~x)
dfpredict %>%
ggplot(aes(y=predicted, x=group)) +
geom_point() +
facet_wrap(~x) +
stat_pvalue_manual(test)
test$y.position <- c(7,7,7,7)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group2 <- as.character(c(1,1,1,1))
test$y.position <- c(7,7,7,7)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- as.character(c(0,0,0,0))
test$group2 <- as.character(c(1,1,1,1))
test$y.position <- c(7,7,7,7)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
test
dfpredict %>%
ggplot(aes(y=predicted, x=group)) +
geom_point() +
facet_wrap(~x) +
stat_pvalue_manual(test)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- as.character(c(0,0,0,0))
test$group2 <- as.character(c(1,1,1,1))
test$y.position <- c(5.5,5.5,5.5,5.5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
test
dfpredict %>%
ggplot(aes(y=predicted, x=group)) +
geom_point() +
facet_wrap(~x) +
stat_pvalue_manual(test)
test <- pair$`simple contrasts for Antibiotic resistant` %>%
tidy()
test$group1 <- as.character(c(0,0,0,0))
test$group2 <- as.character(c(1,1,1,1))
test$y.position <- c(5.5,6.5,5.5,6.5)
test <- mutate(test,x=factor(`Phylum`)) %>%
select(group1, group2, x, p=p.value, y.position)
test
dfpredict %>%
ggplot(aes(y=predicted, x=group)) +
geom_point() +
facet_wrap(~x) +
stat_pvalue_manual(test)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point() +
facet_wrap(~x) +
stat_pvalue_manual(test)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point() +
stat_pvalue_manual(test)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25) ) +
stat_pvalue_manual(test)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25) ) +
stat_pvalue_manual(test,x = x)
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25) ) +
stat_pvalue_manual(test,x = "x")
dfpredict %>%
ggplot(aes(y=predicted, x=x, col=group)) +
geom_point(position = position_dodge(0.25) ) +
stat_pvalue_manual(test,x="x")
p1
p1+
stat_pvalue_manual(test,x="x")
p1+
stat_pvalue_manual(test,x="x")
# Finding the largest 5 orders
Dall %>%
group_by(order) %>%
summarise(n=n()) %>%
arrange(desc(n))
# Finding their % of the total entries
(140+126+85+71+66)/1193
# Finding the median 16S number + entropy joined at orders
Dall %>%
summarise(`16S rDNA copynumber`=mean(n16),.by=order) %>%
summarise(median(`16S rDNA copynumber`),quantile(`16S rDNA copynumber`, 0.25),quantile(`16S rDNA copynumber`, 0.75))
Dall %>%
summarise(div = mean(div),.by=order) %>%
summarise(median(div),quantile(div, 0.25),quantile(div, 0.75))
# Finding the median 16S number + entropy for the entire dataset
Dall %>%
rename(`16S rDNA copynumber`=n16) %>%
summarise(median(`16S rDNA copynumber`),quantile(`16S rDNA copynumber`, 0.25),quantile(`16S rDNA copynumber`, 0.75))
Dall %>%
summarise(median(div),quantile(div, 0.25),quantile(div, 0.75))
